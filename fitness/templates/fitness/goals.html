{% load static %}

<!DOCTYPE html>
<html>

<head>

    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>About Page</title>

    <link rel="stylesheet" type="text/css" href="{% static 'fitness/vendor/bootstrap/css/bootstrap.min.css' %}">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css">
    <link rel="stylesheet" type="text/css" href="{% static 'fitness/css/about.css' %}" />
    <script type="text/javascript" src="{% static 'fitness/vendor/jquery/jquery-3.3.1.min.js' %}"></script>
    <script type="text/javascript" src="{% static 'fitness/vendor/paper/paper-full.min.js' %}"></script>


    <style>

        table, td {
          margin-top: 25px;
          border: 1px solid black;
          border-collapse: collapse;
        }

        td {
          padding: 15px;
        }

        .text-block-1 {
            margin: auto;
            width: 50%;
            text-align: center;
            font-size: 50px;
        }

        .space {
            margin-top: 25px;
        }

        .add {
            text-align: center;
            font-size: 50px;
            margin-left: 47%;
        }

        .progress {
            position: absolute;
            bottom: 20px;
            left: 20px;
            font-size: 40px;
            border-style: solid;
            text-align: center;
            height: 150px;
            width: 300px;
            border-color: MediumPurple;
            background-color: Lavender;
        }

        .achievements {
            position: absolute;
            bottom: 20px;
            right: 20px;
            font-size: 40px;
            border-style: solid;
            text-align: center;
            height: 150px;
            width: 300px;
            border-color: Khaki;
            background-color: LemonChiffon;
        }

        .tableStyle {
            width: 60%;
            margin-left: 20%;
        }

        .numWidth {
            width: 10%;
        }

        .crossSize {
            font-size: 40px;
        }




        #background-form5 {
            position: absolute;
            margin-left: 30%;
            width: 400px;
            height: 230px;
            outline: 30px;
            outline-width: thick;
            outline-style: outset;
            outline-color: goldenrod;
            background-color: whitesmoke;
        }

        .mytxt {
            position: absolute;
            margin-left: 35%;
            margin-top: 3%;
        }

        #locForm {

        }

        #areaChoose {
            font-weight: bold;
            font-size: 25px;
        }

        #myform {

        }


        </style>
</head>

    <body class ="body">

        <br>

        <div>
          <i class="bi bi-arrow-left" onclick="goBack()" style="font-size:4em; margin-left:5%; font-weight:bold;"></i>
            <div class="text-block-1">My Goals</div>
        </div>
        <br><br>


        <div id="tableHolder">
            <table class='tableStyle'>
                <tr>
                    <td> Placeholder Goal </td>
                    <td class='numWidth'> <i class='bi bi-x crossSize' onclick='removeGoal(this);' style ='color:red';> </i> </td>
                    <td class='numWidth'> <i class='bi bi-check-lg' style='color:green'; onclick='archiveGoal(this)'> </i> </td>
                </tr>
            </table>


        </div>


        <br><br>

        <div id="phCircle">
            <i class="bi bi-plus-circle-fill add" onclick='clickGoal();'> </i>
        </div>


        <!-- FORM FOR SUBMITTING A GOAL -->
        <div id="phForm">
            <div id="background-form5"> </div>
            <form class='mytxt' name='areaform' id="locForm">
                <label for='myform' id='areaChoose'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Add a goal!</label>

                <br><br>

                <input type='textarea' id='myform' value=''>
                    <input type='submit' onclick='submitGoal(); return false'> </input>
                </input>
            </form>
        </div>


        <div>
            <div class="progress" id="phProgress" onclick="location.href='/fitness/goal-progress-archive/';">Goal<br>Progress Archive</div>
        </div>
        <div>
            <div class="achievements" id="phAchievements" onclick="location.href='/fitness/achievements/';">App<br>Achievements</div>
        </div>
    </body>


<script>

    // Hides everything else and pops up the form
    function clickGoal() {
        $("#tableHolder").hide();
        $("#phCircle").hide();
        $("#phProgress").hide();
        $("#phAchievements").hide();
        $("#phForm").show();
    }


    function removeGoal(el) {
        el.parentNode.parentNode.remove();
    }

    // Make sure your goal text is the very top <td>, else this fails
    function archiveGoal(el) {
        var goalText = el.closest(".tableStyle").rows[0].cells[0].textContent;

        var goalStorage = localStorage.getItem("myGoalText");
        console.log(goalStorage);

        // if we did not submit ANY goal at all
        if (goalStorage === null) {
            var goalArray = [];
            goalArray.push(goalText);
            localStorage.setItem("myGoalText", JSON.stringify(goalArray));

        // if we have previous goals submitted already
        } else {

            var store = JSON.parse(goalStorage);
            store.push(goalText);
            localStorage.setItem("myGoalText", JSON.stringify(store));
        }

        removeGoal(el);
    }


    function submitGoal() {
        var myGoal = document.areaform.myform.value;

        $("#tableHolder").append("<table class='tableStyle'> <tr> <td>" + myGoal + "</td> <td class='numWidth'> <i class='bi bi-x crossSize' onclick='removeGoal(this);' style ='color:red';> </i> </td> <td class='numWidth'> <i class='bi bi-check-lg' style='color:green'; onclick='archiveGoal(this)'> </i> </td> </tr></table>");


        $("#phForm").hide();
        $("#tableHolder").show();
        $("#phCircle").show();
        $("#phProgress").show();
        $("#phAchievements").show();
        document.areaform.myform.value ="";
    }




    function goBack() {
      window.history.back();
    }

    function init() {
        $("#phForm").hide();
    }

    init();

</script>

</html>
